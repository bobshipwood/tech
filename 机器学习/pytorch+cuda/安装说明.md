[toc]

# 1 确认pytorch版本的最低算力要求

>>> import torch
>>> print(torch.__version__)
>>> pytorch1.10之后的版本最低算力要求为5.0

算力查询
https://developer.nvidia.com/cuda-gpus

# 2 安装cuda

## 2.1 检查cuda版本

cmd下输入nvidia-smi，查看其使用的cuda版本

## 2.2 访问网站并下载指定的版本

https://developer.nvidia.com/cuda-toolkit-archive

## 2.3 验证安装

```
cmd下输入 nvcc -V
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2024 NVIDIA Corporation
Built on Fri_Jun_14_16:44:19_Pacific_Daylight_Time_2024
Cuda compilation tools, release 12.6, V12.6.20
Build cuda_12.6.r12.6/compiler.34431801_0

```

# 3 安装cuDNN（可选？ 因pytorch已经集成了cudnn）

## 3.1 选择版本下载

https://developer.download.nvidia.com/compute/cudnn/redist/cudnn/windows-x86_64/
这里选择cuda12版本cudnn-windows-x86_64-9.8.0.87_cuda12-archive.zip，
9.8.0.87对应着下方的v9.8目录名字

## 3.2 解压缩并拷贝至相应目录

```
Copy bin\cudnn*.dll to C:\Program Files\NVIDIA\CUDNN\v9.x\bin.

Copy include\cudnn*.h to C:\Program Files\NVIDIA\CUDNN\v9.x\include.

Copy lib\x64\cudnn*.lib to C:\Program Files\NVIDIA\CUDNN\v9.x\lib.
```

## 3.3 设置环境变量

```
系统环境变量
Variable Name: PATH
Value to Add: C:\Program Files\NVIDIA\CUDNN\v9.x\bin
```

## 3.4 或者直接pip install 

```
pip install nvidia-cudnn-cu12
```

# 4 安装pytorch（应已集成cuDNN）

直接官网选择版本下载就行了
pip3 install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu126